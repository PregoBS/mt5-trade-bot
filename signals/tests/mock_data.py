from api.market_data_api import MarketDataAPI
import numpy as np
import pandas as pd


def btc_dataframe() -> pd.DataFrame:
    index = np.array([
        '2022-08-01T20:00:00.000000000',
        '2022-08-01T21:00:00.000000000',
        '2022-08-01T22:00:00.000000000',
        '2022-08-01T23:00:00.000000000',
        '2022-08-02T00:00:00.000000000',
        '2022-08-02T01:00:00.000000000',
        '2022-08-02T02:00:00.000000000',
        '2022-08-02T03:00:00.000000000',
        '2022-08-02T04:00:00.000000000',
        '2022-08-02T05:00:00.000000000',
        '2022-08-02T06:00:00.000000000',
        '2022-08-02T07:00:00.000000000',
        '2022-08-02T08:00:00.000000000',
        '2022-08-02T09:00:00.000000000',
        '2022-08-02T10:00:00.000000000',
        '2022-08-02T11:00:00.000000000',
        '2022-08-02T12:00:00.000000000',
        '2022-08-02T13:00:00.000000000',
        '2022-08-02T14:00:00.000000000',
        '2022-08-02T15:00:00.000000000'
    ])
    data = np.array([
        [2, 23637.97, 23904.46, 23624.96, 23884.96, 4519, 0, 606, 23586.30, 23475.80, 0],
        [2, 23832.46, 24211.47, 23775.02, 23958.56, 3451, 0, 606, 23627.60, 23503.61, 0],
        [2, 23957.97, 24022.46, 23806.96, 23848.76, 3833, 0, 606, 23652.23, 23523.49, 0],
        [2, 23846.96, 23973.72, 23826.48, 23957.72, 2932, 0, 606, 23686.17, 23548.48, 0],
        [2, 23958.46, 24097.22, 23918.22, 24062.86, 4480, 0, 606, 23728.03, 23578.07, 0],
        [2, 24060.97, 24500.97, 24054.96, 24443.73, 5823, 0, 606, 23807.55, 23627.85, 0],
        [2, 24449.46, 24468.47, 24208.73, 24270.73, 4366, 0, 606, 23859.02, 23664.81, 0],
        [2, 24270.00, 24382.97, 24218.97, 24329.72, 3247, 0, 606, 23911.32, 23703.02, 0],
        [2, 24329.72, 24547.72, 24295.96, 24526.95, 3241, 0, 606, 23979.72, 23750.35, 0],
        [2, 24530.48, 24663.22, 24483.10, 24567.72, 5313, 0, 606, 24045.06, 23797.29, 0],
        [2, 24571.22, 24633.46, 24495.72, 24557.22, 3649, 0, 606, 24101.97, 23840.92, 0],
        [2, 24556.97, 24754.22, 24374.72, 24450.21, 4660, 0, 606, 24140.66, 23875.90, 0],
        [2, 24450.17, 24572.83, 24358.95, 24536.22, 3990, 0, 606, 24184.61, 23913.79, 0],
        [2, 24535.72, 24552.44, 24452.96, 24454.47, 3397, 0, 606, 24214.60, 23944.81, 0],
        [2, 24454.22, 24532.84, 24393.48, 24495.59, 3870, 0, 606, 24245.82, 23976.40, 0],
        [2, 24492.33, 24682.83, 24481.46, 24564.82, 4201, 0, 632, 24281.26, 24010.14, 0],
        [2, 24566.67, 24912.83, 24535.33, 24877.84, 6641, 0, 632, 24347.55, 24059.89, 0],
        [2, 24879.33, 24889.34, 24547.83, 24735.83, 6680, 0, 632, 24390.69, 24098.63, 0],
        [2, 24735.83, 24882.85, 24434.59, 24573.83, 6523, 0, 632, 24411.04, 24125.87, 0],
        [2, 24577.09, 24593.33, 24300.85, 24373.33, 5963, 0, 632, 24406.85, 24140.05, 0],
    ])
    columns = MarketDataAPI.DATAFRAME_COLUMNS.copy()
    columns.append("EMA17")
    columns.append("EMA34")
    columns.append("EMACrossover_17_34")
    print(columns)
    return pd.DataFrame(data=data, columns=columns, index=index)
